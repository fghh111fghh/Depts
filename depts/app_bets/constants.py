"""
Константы для приложения анализа ставок.

Разделы:
1. Исходы матчей (Outcome)
2. Анализ матчей
3. Парсинг данных
4. Сообщения и тексты
"""

from decimal import Decimal


class Outcome:
    """
    Исходы матчей для анализа паттернов.
    Используется в анализе форм команд.
    """
    WIN = 'В'  # Победа
    LOSE = 'П'  # Поражение
    DRAW = 'Н'  # Ничья


class AnalysisConstants:
    """
    Константы для анализа футбольных матчей.

    Настройки для различных методов анализа:
    - Пуассон: расчет вероятностей счетов
    - Близнецы: поиск исторических матчей с похожими коэффициентами
    - Паттерны: анализ форм команд
    - Векторный синтез: формирование итогового вердикта
    """

    # ==================== ДОПУСКИ ДЛЯ "БЛИЗНЕЦОВ" ====================
    TWINS_TOLERANCE_SMALL = Decimal('0.05')  # 5% - малый допуск
    TWINS_TOLERANCE_LARGE = Decimal('0.10')  # 10% - расширенный допуск

    # ==================== ПАРАМЕТРЫ ПАТТЕРНОВ ====================
    PATTERN_FORM_LENGTH = 4  # Длина паттерна формы (последние 4 матча)

    # ==================== ПАРАМЕТРЫ ПУАССОНА ====================
    POISSON_MAX_GOALS = 8  # Максимальное количество голов для расчета
    POISSON_MIN_LAMBDA = 0.01  # Минимальное значение лямбды

    # ==================== ПОРОГИ ДЛЯ ПРИНЯТИЯ РЕШЕНИЙ ====================
    VERDICT_STRONG_THRESHOLD = 0.60  # Порог для СИГНАЛА (≥60%)
    VERDICT_WEAK_THRESHOLD = 0.40  # Порог для АКЦЕНТА (≥40%)
    WIN_THRESHOLD = 0.45  # Порог победы для учета (≥45%)
    DRAW_THRESHOLD = 0.30  # Порог ничьей для учета (≥30%)

    # ==================== ВЕСА ДЛЯ ВЕКТОРНОГО СИНТЕЗА ====================
    POISSON_WEIGHT = 0.2  # Вес метода Пуассона (20%)
    TWINS_WEIGHT = 0.4  # Вес метода "близнецов" (40%)
    PATTERN_WEIGHT = 0.4  # Вес метода паттернов (40%)

    # ==================== МИНИМАЛЬНЫЕ ЗНАЧЕНИЯ ====================
    MIN_PROBABILITY = 0.01  # Минимальная вероятность для учета (%)
    MIN_TEAM_NAME_LENGTH = 2  # Минимальная длина названия команды

    HISTORICAL_YEARS = 20  # Глубина исторического анализа в годах
    HISTORICAL_MIN_MATCHES = 50  # Минимальное количество матчей для выборки
    HISTORICAL_MAX_SAMPLE = 2000  # Максимальный размер выборки для производительности
    HISTORICAL_SIMILARITY_THRESHOLD = 20  # Минимальный порог похожести
    HISTORICAL_WEIGHT_CAP = 5.0  # Максимальный вес для байесовской коррекции
    TOTAL_THRESHOLD = 2.5  # Порог для тотала больше/меньше
    TOTAL_OVER = 'БОЛЬШЕ'
    TOTAL_UNDER = 'МЕНЬШЕ'
    # Уровни уверенности
    CONFIDENCE_HIGH = 'ВЫСОКАЯ'
    CONFIDENCE_MEDIUM = 'СРЕДНЯЯ'
    CONFIDENCE_LOW = 'НИЗКАЯ'
    CONFIDENCE_RANDOM = 'СЛУЧАЙНАЯ'

    # Прогнозы
    PREDICTION_OVER = 'БОЛЬШЕ'
    PREDICTION_UNDER = 'МЕНЬШЕ'
    PREDICTION_FIFTY = '50/50'


class ParsingConstants:
    """
    Константы для парсинга текстовых данных.

    Настройки для извлечения информации из текста:
    - Регулярные выражения для различных форматов
    - Параметры поиска названий команд
    - Ключевые слова для фильтрации
    """

    # ==================== РЕГУЛЯРНЫЕ ВЫРАЖЕНИЯ ====================
    ODDS_REGEX = r'^\d+[\.,]\d+$'  # Коэффициенты (1.23 или 1,23)
    TIME_REGEX = r'^\d{1,2}[:\.]\d{2}$'  # Время (20:30 или 20.30)
    DIGITS_ONLY_REGEX = r'^\d+$'  # Только цифры

    # ==================== ПАРАМЕТРЫ ПОИСКА ====================
    MAX_SEARCH_DEPTH = 10  # Максимальное количество строк для поиска команд
    MAX_LINES_PER_MATCH = 20  # Максимальное количество строк на матч

    # ==================== КЛЮЧЕВЫЕ СЛОВА ДЛЯ ПРОПУСКА ====================
    SKIP_KEYWORDS = {
        '-', 'vs', 'v', 'против', 'against',
        '1', 'x', '2', '1x2', '1 x 2', '1 x 2'
    }

    # ==================== НАЗВАНИЯ ЛИГ И СТРАН ====================
    LEAGUE_KEYWORDS = {
        'чемпионшип', 'бундеслига', 'примера', 'ла лига', 'премьер лига',
        'англия', 'германия', 'испания', 'италия', 'франция', 'россия',
        'лига 1', 'лига 2', 'серия а', 'серия б', 'вторая', 'первая'
    }

    # ==================== ЧЕРНЫЙ СПИСОК КОРОТКИХ СТРОК ====================
    BLACKLIST = {'1', '2', 'x', 'xi', 'x1', 'x2', 'i', 'ii', 'iii', 'iv', 'v', 'vi'}

    DIV_TO_LEAGUE_NAME = {
        'E0': 'АПЛ',
        'E1': 'Чемпионшип',
        'D1': 'Бундеслига',
        'D2': 'Бундеслига 2',
        'SP1': 'Ла Лига',
        'SP2': 'Сегунда',
        'I1': 'Серия А',
        'I2': 'Серия Б',
        'F1': 'Лига 1',
        'F2': 'Лига 2',
        'N1': 'Эредивизи',
    }


class Messages:
    """
    Текстовые сообщения и подсказки для интерфейса.

    Используются для отображения результатов и ошибок.
    """

    # ==================== СООБЩЕНИЯ ОБ ОШИБКАХ ====================
    NO_DATA_MESSAGE = "Не удалось распознать данные матчей."
    TEAM_NOT_FOUND = "Команда не найдена в базе данных."
    INSUFFICIENT_DATA = "Недостаточно данных для анализа."

    # ==================== ВЕРДИКТЫ АНАЛИЗА ====================
    VERDICT_SIGNAL_P1 = "СИГНАЛ: П1"
    VERDICT_SIGNAL_P2 = "СИГНАЛ: П2"
    VERDICT_SIGNAL_DRAW = "СИГНАЛ: НИЧЬЯ"
    VERDICT_ACCENT_1X = "АКЦЕНТ: 1X"
    VERDICT_ACCENT_X2 = "АКЦЕНТ: X2"
    VERDICT_NO_CLEAR_VECTOR = "НЕТ ЧЕТКОГО ВЕКТОРА"

    # ==================== СТАТУСЫ АНАЛИЗА ====================
    PATTERN_INSUFFICIENT_DATA = "Недостаточно данных"
    PATTERN_NOT_FOUND = "Паттерн не найден в истории"
    TWINS_NO_DATA = "Нет данных"
    H2H_NO_MATCHES = "Игр в таком статусе не найдено"

    # ==================== ФОРМАТЫ ВЫВОДА ====================
    DATE_FORMAT = '%d.%m.%y'  # Формат даты: 25.12.23
    DECIMAL_FORMAT = '0.00'  # Формат десятичных чисел: 1.50
    PERCENTAGE_FORMAT = '{:.1f}%'  # Формат процентов: 45.5%

    # ==================== ЛОГИРОВАНИЕ ====================
    ALIAS_CREATED = "Создан/обновлен алиас: {} → team_id={}"
    MATCH_FOUND = "Найден матч: {} - {} ({}/{}/{})"
    TOTAL_MATCHES = "Всего найдено матчей: {}"